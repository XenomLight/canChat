# canChat
Open this project in ICP Ninja:

[![](https://icp.ninja/assets/open.svg)](https://icp.ninja/i?g=https://github.com/XenomLight/canChat)

Real-time room-based chat on the Internet Computer (IC) with a session timer, creator-controlled room ending, and a clean React + Vite frontend. **No II Login Required**.

## Features

- Session timer shown in the chat header (top-right), synced to backend activity
- Auto-expiration modal when the room session ends (timeout or creator ends)
- Copyable room invite link with URL param `?refID=ROOMCODE`
- Creator-only “End Room” control that closes the room for everyone
- Smooth message polling and auto-scroll to newest message

## Tech Stack

- Frontend: React 18, Vite, SCSS
- Backend: Motoko canister on IC
- IC SDK: `@dfinity/agent`, `@dfinity/candid`, `@dfinity/principal`

## Project Structure

- `src/canChat_backend/main.mo`: Motoko canister (rooms, messages, timeout, endRoom)
- `src/canChat_frontend/src/App.jsx`: App views, chat UI, timer, modals
- `src/canChat_frontend/src/index.scss`: Global styles, chat UI, modal styles
- `src/declarations/*`: Autogenerated canister bindings (updated to include `endRoom`)

## Backend API (summary)

- `createRoom() -> { Ok: { roomCode, room, sessionId } | Err }`
- `joinRoom(roomCode) -> { Ok: { room, sessionId } | Err }`
- `sendMessage(roomCode, sessionId, text) -> { Ok: Message | Err }`
- `getRoom(roomCode) -> ?Room`
- `getMessages(roomCode) -> [Message]`
- `leaveRoom(roomCode, sessionId) -> Bool`
- `endRoom(roomCode, sessionId) -> Bool` (creator-only)

Room timeout: 20 minutes since last activity. On expiry, room is removed and clients show the session-ended modal.

## Development

Frontend scripts (from `src/canChat_frontend`):

```bash
npm run dev         # Start Vite dev server (alias of start)
npm run start       # Vite on port 3000
npm run build       # Production build
npm run format      # Format source files
npm run setup       # Install, create canister, generate, deploy
```

DFX basics (run at project root):

```bash
dfx start --background
dfx deploy
```

## Running the project locally

```bash
git clone https://github.com/XenomLight/canChat
dfx start --background
cd canChat
dfx deploy
```

When deployed locally, the asset canister URL is typically printed by `dfx deploy`.

## License

MIT
